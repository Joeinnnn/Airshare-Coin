<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Trades Overlay</title>
<style>
  html, body { margin:0; padding:0; background:transparent; }
  body { font-family: Arial, Helvetica, sans-serif; overflow:hidden; }

  /* centered popup container */
  .popup {
    position: absolute;
    left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    display: none;
    text-align: center;
    color: #fff;
  }

  .trade-text {
    font-weight: 700;
    font-size: 56px;          /* adjust in OBS if needed */
    text-shadow: 0 4px 20px rgba(0,0,0,.6);
    margin-top: 8px;
  }

  .gif {
    display: block;
    margin: 0 auto;
    max-width: 420px;         /* gif size */
    max-height: 420px;
  }

  /* subtle fade in/out */
  .show { animation: fadeIn .25s ease-out forwards; }
  .hide { animation: fadeOut .25s ease-in forwards; }
  @keyframes fadeIn { from {opacity:0; transform: translate(-50%,-50%) scale(.95);} to {opacity:1; transform: translate(-50%,-50%) scale(1);} }
  @keyframes fadeOut { from {opacity:1;} to {opacity:0;} }
</style>
</head>
<body>
  <div id="popup" class="popup">
    <img id="gif" class="gif" src="" alt="celebration" />
    <div id="trade" class="trade-text"></div>
  </div>
  <audio id="sfx" preload="auto">
    <source src="kaching.mp3" type="audio/mpeg" />
  </audio>

<script>
  const popup = document.getElementById("popup");
  const gifEl = document.getElementById("gif");
  const tradeEl = document.getElementById("trade");

  const gifs = ["GIF1.gif","GIF2.gif","GIF3.gif","GIF4.gif"]; // must exist next to this file
  let last = "";

  async function poll() {
    try {
      const txt = await fetch("trades.txt?bust=" + Date.now()).then(r => r.text());
      const trade = (txt || "").trim();
      if (trade && trade !== last) {
        last = trade;

        // update content
        tradeEl.textContent = trade;
        gifEl.style.display = "block";
        gifEl.src = gifs[Math.floor(Math.random() * gifs.length)] + "?t=" + Date.now();

        // play sound
        try { document.getElementById('sfx').currentTime = 0; document.getElementById('sfx').play(); } catch(_) {}

        // show for 3 seconds
        popup.classList.remove("hide");
        popup.classList.add("show");
        popup.style.display = "block";
        clearTimeout(window.__t);
        window.__t = setTimeout(() => {
          popup.classList.remove("show");
          popup.classList.add("hide");
          setTimeout(() => { popup.style.display = "none"; gifEl.style.display = "none"; gifEl.src = ""; }, 250);
        }, 3000);
      }
    } catch(e) {
      // ignore fetch errors during scene switches
    }
  }
  setInterval(poll, 1500);
</script>
</body>
</html>
